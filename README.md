# laravel
Проект laravel с использованием inertia и vue

## Установка
Нужно выполнить клонирование
```
git clone git@github.com:DimaKrymskikh/laravel.git
```
Будет создана папка `laravel`. 
После перехода в эту папку следует выполнить команды
```
composer install
npm install
```

Далее нужно создать файл `.env` и скопировать в него содержимое файла `.env.example`. Затем, в файле `.env` необходимо определить переменные окружения.

## Использование докера
Существует следующая проблема.
Может оказаться, что в файле
```
./vendor/laravel/sail/runtimes/8.2/Dockerfile
```
переменная `POSTGRES_VERSION=14`, нужно исправить на `POSTGRES_VERSION=15` (на версию контейнера `pgsql`).

После этого, можно собрать контейнеры, выполнив команду
```
sail up -d
```
Команда
```
sail artisan migrate
```
создаст таблицы.
Команда
```
sail artisan db:seed
```
заполнит таблицы данными.
Далее, нужно собрать фронтенд, выполнив команду
```
npm run build
```
После этого, задав в строке браузера `http://localhost/`, можно будет увидеть приложение.
(Должен быть свободным порт 80)

## Взаимодействие с сервером OpenWeather
Нужно зарегистрироваться на [OpenWeather](https://openweathermap.org/)  и получить там API Key, который нужно вставить в переменную окружения `OPENWEATHER_KEY=` файла `.env`.
После этого команда 
```
sail artisan get:weather
```
будет получать погоду для всех городов из таблицы `thesaurus.cities`.
(Вызов этой команды с параметром `open_weather_id` получит погоду для данного города.)
Команду 
```
sail artisan statistics:weather <open_weather_id>
```
можно использовать для просмотра статистики погоды данного города
(данная команда без параметра выдаст статистику по всем городам).
Добавить новые города можно в UI пользователя.

## Тестирование
Для запуска тестов бэкенда нужно выполнить команду
```
sail test
```
или 
```
sail test --coverage
```
чтобы увидеть покрытие проекта тестами.

Тесты фронтенда с результатом покрытия запускаются коммандой
```
npm run coverage
```
